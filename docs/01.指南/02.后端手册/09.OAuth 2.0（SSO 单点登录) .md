---
title: OAuth 2.0ï¼ˆSSO å•ç‚¹ç™»å½•) #
date: 2024-01-14 19:33:01
permalink: /pages/888305/
---

## OAuth 2.0 æˆæƒæ¨¡å¼çš„é€‰æ‹©ï¼Ÿ

æˆæƒæ¨¡å¼çš„é€‰æ‹©ï¼Œå…¶å®éå¸¸ç®€å•ï¼Œæ€»ç»“èµ·æ¥å°±æ˜¯ä¸€å¼ å›¾ï¼š

![](https://ximu233.oss-cn-shenzhen.aliyuncs.com/econets-vue/doc_econets_pic_9.png)

> é—®é¢˜ä¸€ï¼šä»€ä¹ˆåœºæ™¯ä¸‹ï¼Œä½¿ç”¨å®¢æˆ·ç«¯æ¨¡å¼ï¼ˆClient Credentialsï¼‰ï¼Ÿ

å¦‚æœä»¤ç‰Œæ‹¥æœ‰è€…æ˜¯**æœºå™¨**çš„æƒ…å†µä¸‹ï¼Œé‚£å°±ä½¿ç”¨å®¢æˆ·ç«¯æ¨¡å¼ã€‚ ä¾‹å¦‚è¯´ï¼š

- å¼€å‘äº†ä¸€ä¸ªå¼€æ”¾å¹³å°ï¼Œæä¾›ç»™å…¶å®ƒå¤–éƒ¨æœåŠ¡è°ƒç”¨
- å¼€å‘äº†ä¸€ä¸ª RPC æœåŠ¡ï¼Œæä¾›ç»™å…¶å®ƒå†…éƒ¨æœåŠ¡è°ƒç”¨

å®é™…çš„æ¡ˆä¾‹ï¼Œæˆ‘ä»¬æ¥å…¥å¾®ä¿¡å…¬ä¼—å·æ—¶ï¼Œä¼šä½¿ç”¨ `appid` å’Œ `secret` å‚æ•°ï¼Œ[è·å– Access token ](https://developers.weixin.qq.com/doc/offiaccount/Basic_Information/Get_access_token.html)è®¿é—®ä»¤ç‰Œã€‚

> é—®é¢˜äºŒï¼šä»€ä¹ˆåœºæ™¯ä¸‹ï¼Œä½¿ç”¨å¯†ç æ¨¡å¼ï¼ˆResource Owner Password Credentialsï¼‰ï¼Ÿ

æ¥å…¥çš„ Client å®¢æˆ·ç«¯ï¼Œæ˜¯å±äº**è‡ªå·±**çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨å¯†ç æ¨¡å¼ã€‚ ä¾‹å¦‚è¯´ï¼š

- å®¢æˆ·ç«¯æ˜¯ä½ è‡ªå·±å…¬å¸çš„ App æˆ–ç½‘é¡µï¼Œç„¶åæˆæƒæœåŠ¡ä¹Ÿæ˜¯ä½ å…¬å¸çš„

ä¸è¿‡ï¼Œå¦‚æœå®¢æˆ·ç«¯æ˜¯**ç¬¬ä¸‰æ–¹**çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨å¯†ç æ¨¡å¼çš„è¯ï¼Œè¯¥å®¢æˆ·ç«¯æ˜¯å¯ä»¥æ‹¿åˆ°ç”¨æˆ·çš„è´¦å·ã€å¯†ç ï¼Œå­˜åœ¨å®‰å…¨çš„é£é™©ï¼Œæ­¤æ—¶å¯ä»¥è€ƒè™‘ä½¿ç”¨æˆæƒç æˆ–ç®€åŒ–æ¨¡å¼ã€‚

> é—®é¢˜ä¸‰ï¼šä»€ä¹ˆåœºæ™¯ä¸‹ï¼Œä½¿ç”¨æˆæƒç æ¨¡å¼ï¼ˆAuthorization Codeï¼‰ï¼Ÿ

æ¥å…¥çš„ Client å®¢æˆ·ç«¯ï¼Œæ˜¯å±äº**ç¬¬ä¸‰æ–¹**çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨æˆæƒç æ¨¡å¼ã€‚ä¾‹å¦‚è¯´ï¼š

- å®¢æˆ·ç«¯æ˜¯ä½ è‡ªå·±å…¬å¸çš„ App æˆ–ç½‘é¡µï¼Œä½œä¸ºç¬¬ä¸‰æ–¹ï¼Œæ¥å…¥ [å¾®ä¿¡](https://developers.weixin.qq.com/doc/offiaccount/OA_Web_Apps/Wechat_webpage_authorization.html)ã€[QQ](https://wiki.connect.qq.com/oauth2-0ç®€ä»‹)ã€[é’‰é’‰](https://open.dingtalk.com/document/mobile-app-guide/mobile-application-access)ç­‰ç­‰è¿›è¡Œ OAuth 2.0 ç™»å½•

å½“ç„¶ï¼Œå¦‚æœå®¢æˆ·ç«¯æ˜¯**è‡ªå·±**çš„æƒ…å†µä¸‹ï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨æˆæƒç æ¨¡å¼ã€‚ä¾‹å¦‚è¯´ï¼š

- å®¢æˆ·ç«¯æ˜¯è…¾è®¯æ——ä¸‹çš„å„ç§æ¸¸æˆï¼Œå¯ä½¿ç”¨å¾®ä¿¡ã€QQï¼Œæ¥å…¥ [å¾®ä¿¡\](https://developers.weixin.qq.com/doc/offiaccount/OA_Web_Apps/Wechat_webpage_authorization.html)ã€[QQ](https://wiki.connect.qq.com/oauth2-0ç®€ä»‹)ç­‰ç­‰è¿›è¡Œ OAuth 2.0 ç™»å½•
- å®¢æˆ·ç«¯æ˜¯å…¬å¸å†…çš„å„ç§ç®¡ç†åå°ï¼ˆERPã€OAã€CRM ç­‰ï¼‰ï¼Œè·³è½¬åˆ°ç»Ÿä¸€çš„ SSO å•ç‚¹ç™»å½•ï¼Œä½¿ç”¨æˆæƒç æ¨¡å¼è¿›è¡Œæˆæƒ

> é—®é¢˜å››ï¼šä»€ä¹ˆåœºæ™¯ä¸‹ï¼Œä½¿ç”¨ç®€åŒ–æ¨¡å¼ï¼ˆImplicitï¼‰ï¼Ÿ

ç®€åŒ–æ¨¡å¼ï¼Œ**ç®€åŒ–** çš„æ˜¯æˆæƒç æ¨¡å¼çš„æµç¨‹çš„ **ç¬¬äºŒæ­¥**ï¼Œå·®å¼‚åœ¨äºï¼š

- æˆæƒç æ¨¡å¼ï¼šæˆæƒå®Œæˆåï¼Œè·å¾—çš„æ˜¯ code æˆæƒç ï¼Œéœ€è¦ Server Side æœåŠ¡ç«¯ä½¿ç”¨è¯¥æˆæƒç ï¼Œå†å‘æˆæƒæœåŠ¡å™¨è·å– Access Token è®¿é—®ä»¤ç‰Œ
- ç®€åŒ–æ¨¡å¼ï¼šæˆæƒå®Œæˆåï¼ŒClient Side å®¢æˆ·ç«¯ç›´æ¥è·å¾— Access Token è®¿é—®ä»¤ç‰Œ

æš‚æ—¶æ²¡æœ‰ç‰¹åˆ«å¥½çš„æ¡ˆä¾‹ï¼Œæ„Ÿå…´è¶£å¯ä»¥çœ‹çœ‹å¦‚ä¸‹æ–‡æ¡£ï¼Œä¹Ÿå¯ä»¥ä¸çœ‹ï¼š

- [ã€ŠQQ OAuth 2.0 å¼€å‘æŒ‡å®š â€”â€” å¼€å‘æ”»ç•¥_Client-sideã€‹](https://wiki.connect.qq.com/å¼€å‘æ”»ç•¥_client-side)
- [ã€Šç™¾åº¦ OAuth â€”â€” Implicit Grant æˆæƒã€‹](http://developer.baidu.com/wiki/index.php?title=docs/oauth/implicit)

> é—®é¢˜äº”ï¼šè¯¥é¡¹ç›®ä¸­ï¼Œä½¿ç”¨äº†å“ªäº›æˆæƒæ¨¡å¼ï¼Ÿ

![](https://ximu233.oss-cn-shenzhen.aliyuncs.com/econets-vue/doc_econets_pic_10.png)

å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œåˆ†æˆ **å¤–éƒ¨æˆæƒ** å’Œ **å†…éƒ¨ç™»å½•** ä¸¤ç§æ–¹å¼ã€‚

â‘  çº¢è‰²çš„â€œå¤–éƒ¨æˆæƒâ€ï¼šåŸºäºã€æˆæƒç æ¨¡å¼ã€‘ï¼Œå®ç° SSO å•ç‚¹ç™»å½•ï¼Œå°†ç”¨æˆ·æˆæƒç»™æ¥å…¥çš„å®¢æˆ·ç«¯ã€‚å®¢æˆ·ç«¯å¯ä»¥æ˜¯å†…éƒ¨çš„å…¶å®ƒç®¡ç†ç³»ç»Ÿï¼Œä¹Ÿå¯ä»¥æ˜¯å¤–éƒ¨çš„ç¬¬ä¸‰æ–¹ã€‚

â‘¡ ç»¿è‰²çš„â€œå†…éƒ¨ç™»å½•â€ï¼šç®¡ç†åå°çš„ç™»å½•æ¥å£ï¼Œè¿˜æ˜¯é‡‡ç”¨ä¼ ç»Ÿçš„ `/admin-api/system/auth/login`è´¦å·å¯†ç ç™»å½•ï¼Œå¹¶æ²¡æœ‰ä½¿ç”¨ã€å¯†ç æ¨¡å¼ã€‘ï¼Œä¸»è¦è€ƒè™‘é™ä½å¤§å®¶çš„å­¦ä¹ æˆæœ¬ï¼Œå¦‚æœæ²¡æœ‰å°†ç”¨æˆ·æˆæƒç»™å…¶å®ƒç³»ç»Ÿçš„æƒ…å†µä¸‹ï¼Œè¿™æ ·åšå·²ç»å¯ä»¥å¾ˆå¥½çš„æ»¡è¶³ä¸šåŠ¡çš„éœ€è¦ã€‚å½“ç„¶ï¼Œè¿™é‡Œä¹Ÿå¯ä»¥å°†ç®¡ç†åå°ä½œä¸ºä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œä½¿ç”¨ã€å¯†ç æ¨¡å¼ã€‘è¿›è¡Œæˆæƒã€‚

å¦å¤–ï¼Œè€ƒè™‘åˆ° OAuth 2.0 ä½¿ç”¨çš„è®¿é—®ä»¤ç‰Œ + åˆ·æ–°ä»¤ç‰Œå¯ä»¥æä¾›æ›´å¥½çš„å®‰å…¨æ€§ï¼Œæ‰€ä»¥å³ä½¿æ˜¯ä¼ ç»Ÿçš„è´¦å·å¯†ç ç™»å½•ï¼Œä¹Ÿå¤ç”¨äº†å®ƒä½œä¸ºä»¤ç‰Œçš„å®ç°ã€‚

## OAuth 2.0 æŠ€æœ¯é€‰å‹ï¼Ÿ

å®ç° OAuth 2.0 çš„åŠŸèƒ½ï¼Œä¸€èˆ¬é‡‡ç”¨ [Spring Security OAuth](https://spring.io/projects/spring-security-oauth)æˆ– [Spring Authorization Server](https://spring.io/projects/spring-authorization-server) (SAS) æ¡†æ¶ï¼Œå‰è€…å·²åºŸå¼ƒï¼Œè¢«åè€…æ‰€æ›¿ä»£ã€‚ä½†æ˜¯ä½¿ç”¨å®ƒä»¬ï¼Œä¼šé¢ä¸´ä¸‰å¤§é—®é¢˜ï¼š

- å­¦ä¹ æˆæœ¬å¤§ï¼šSAS æ˜¯æ–°å‡ºçš„æ¡†æ¶ï¼Œå…¥é—¨å®¹æ˜“ç²¾é€šéš¾ï¼Œå¼•å…¥é¡¹ç›®ä¸­éœ€è¦èŠ±è´¹ 1-2 å‘¨æ·±å…¥å­¦ä¹ 
- æ’æŸ¥é—®é¢˜éš¾ï¼šä½¿ç”¨ç¢°åˆ°é—®é¢˜æ—¶ï¼Œå¾€å¾€éœ€è¦è°ƒè¯•åˆ°æºç å±‚é¢ï¼Œå›¢é˜Ÿåªæœ‰ä¸ªåˆ«äººå…·å¤‡è¿™ç§èƒ½åŠ›
- å®šåˆ¶æˆæœ¬é«˜ï¼šæ ¹æ®ä¸šåŠ¡éœ€è¦ï¼Œæƒ³è¦åœ¨ SAS ä¸Šå®šåˆ¶åŠŸèƒ½ï¼Œå¯¹æºç è¦æœ‰ä¸é”™çš„æŒæ§åŠ›ï¼Œéš¾åº¦å¯èƒ½è¿‡å¤§

âš” å› æ­¤ï¼Œé¡¹ç›®å‚è€ƒå¤šä¸ª OAuth 2.0 æ¡†æ¶ï¼Œ**è‡ªç ”**å®ç° OAuth 2.0 çš„åŠŸèƒ½ï¼Œå…·å¤‡å­¦ä¹ æˆæœ¬å°ã€æ’æŸ¥é—®é¢˜å®¹æ˜“ã€å®šåˆ¶æˆæœ¬ä½çš„ä¼˜ç‚¹ï¼Œæ”¯æŒå¤šç§æˆæƒæ¨¡å¼ï¼Œå¹¶å†…ç½® SSO å•ç‚¹ç™»å½•çš„åŠŸèƒ½ã€‚

> å‹æƒ…æç¤ºï¼šå…·å¤‡ä¸€å®šè§„æ¨¡çš„äº’è”ç½‘å…¬å¸ï¼ŒåŸºæœ¬ä¸ä¼šç›´æ¥é‡‡ç”¨ Spring Security OAuth æˆ– Spring Authorization Server æ¡†æ¶ï¼Œä¹Ÿæ˜¯é‡‡ç”¨è‡ªç ”çš„æ–¹å¼ï¼Œæ›´å¥½çš„æ»¡è¶³è‡ªèº«çš„ä¸šåŠ¡éœ€æ±‚ä¸æŠ€æœ¯æ‹“å±•ã€‚
>
> ğŸ™‚ å¦å¤–ï¼Œé€šè¿‡å­¦ä¹ é¡¹ç›®çš„ OAuth 2.0 å®ç°ï¼Œå¯ä»¥è¿›ä¸€æ­¥åŠ æ·±å¯¹ OAuth 2.0 çš„ç†è§£ï¼ŒçŸ¥å…¶ç„¶è€Œä¸çŸ¥å…¶æ‰€ä»¥ç„¶ï¼

æœ€ç»ˆå®ç°çš„æ•´ä½“æ¶æ„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![](https://ximu233.oss-cn-shenzhen.aliyuncs.com/econets-vue/doc_econets_pic_11.png)



## OAuth 2.0 è¡¨ç»“æ„

![](https://ximu233.oss-cn-shenzhen.aliyuncs.com/econets-vue/doc_econets_pic_14.png)